#!/bin/sh
set -eu

sudo apt update
sudo apt upgrade
sudo apt install -y gh zsh gcc

if ! gh auth status; then
    gh auth login --web
fi

chsh -s $(which zsh)
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"

mkdir -p "$HOME/Configurations/"
cd "$HOME/Configurations/"

for repo in \
    git-configuration \
    zsh-configuration \
    tmux-configuration \
    neovim-configuration \
    ghostty-configuration \
    lazygit-configuration
do
    if [ -d "$repo" ]; then
        echo "$repo found, skipping"
        continue
    fi
    git clone "ssh://git@github.com/EskelinenAntti/$repo.git"
    (cd "$repo" && make)
done

# Install ghostty
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/mkasberg/ghostty-ubuntu/HEAD/install.sh)"
